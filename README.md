# MakeNewFtpClientGui
Программа написана на C# (Net Core 3.1) с использованием пакетов Avalonia (0.9.10), Newtonsoft.Json (12.0.3) и System.DirectoryServices (4.7.0).
Задачи, которые решает программа:

    создает учетную запись в ActiveDirectory с определенными заранее настройками (как у всех учетных записей для сторонних клиентов FTP)
    создает папки на FTP для создаваемой учетной записи в зависимости от выбранной сторонней МИС
    выдает права на созданные папки созданной учетной записи
    создает настройки выбранных консолей (выгрузка справочников, обработка входящих заказов, выгрузка готовых результатов) и записывает их в указанные в настройках файлы конфигурации (предварительно создается бэкап конфигурационных файлов)
    если выбрана консоль выгрузки справочников, то создается задание в планировщике на указанном в настройках сервере с указанным временем запуска (раз в сутки)
    для каждой операции выдается сообщение о результате ее выполнения.

Файл настроек:
Settings.json (данные настройки представлены только для примера и не могут использоваться на проде в данном виде!!! ):

    {
        "ConsoleStartsAccountLogin": "SPBHELIX\\int_cons_HelixDicts",
        "ConsoleStartsAccountPassword": "AAA1111bbb@",
        "DictionariesFolderInScheduler": "\\HelixDicts",
        "DictionariesServer": "server1.ru",
        "FtpPath": "//ftp.ru/",
        "PathAD": "OU=FTPgroup,OU=ff,DC=ftp,DC=ru",
        "FullPathToDictsSettings": "C:/Program Files (x86)/Dictionaries.exe",
        "FullPathToGftpRegistratorSettings": "//server2.ru/C$/Program Files (x86)/Configuration.json",
        "FullPathToResultServiceSettings": "//server3.ru/C$/Program Files (x86)/Configuration.json"
    }

ConsoleStartsAccountLogin - логин пользователя. под которым запускается консоль выгрузки справочников (если есть обратная косая черта, то она должна экранироваться обратной косой чертой)

ConsoleStartsAccountPassword - пароль пользователя. под которым запускается консоль выгрузки справочников

DictionariesFolderInScheduler - папка в планировщике заданий на сервере, в которой создается задание для консоли выгрузки справочников

DictionariesServer - полное название сервера, на котором установлена консоль выгрузки справочников

FtpPath - путь до папки FTP, в которой нужно создать папки для создаваемой учетной записи (прямая косая черта должна заменяться обратной косой чертой)

PathAD - контейнер в ActiveDirectory, в котором нужно создать учетные данные ActiveDirectory

FullPathToDictsSettings - путь до файла настроек консоли выгрузки справочников (прямая косая черта должна заменяться обратной косой чертой)

FullPathToGftpRegistratorSettings - путь до файла настроек консоли обработки заказов (прямая косая черта должна заменяться обратной косой чертой)

FullPathToResultServiceSettings - путь до файла настроек сервиса выгрузки результатов (прямая косая черта должна заменяться обратной косой чертой)

Файлы шаблонов (находятся в папке Templates):
Letter.txt - шабон письма

DictsSchedule.xml - шаблон настроек задания планировщика заданий Windows

В папках Dictionaries, GftpRegistrator и ResultService лежат файлы с шаблонами настроек соответствующей консоли для каждой МИС (формат названия - название МИС + расширение json или xml в зависимости от консоли)
